datasource db {
  provider = "postgresql"
  url      = env("PG_DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  posts     Post[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Post {
  id        String   @id @default(cuid())
  title     String
  content   String?
  published Boolean  @default(false)
  author    User     @relation(fields: [authorId], references: [id])
  authorId  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum SourceType {
  url
  keyword
  ticker
}

enum Frequency {
  daily
  weekly
  realtime
}

enum OutputFormat {
  summary
  pdf
  ppt
}

enum Language {
  en
  zh_HK
}

enum Timezone {
  HKT
  ET
}

enum TaskStatus {
  done_today
  scheduled
  error
}

model Task {
  id           String       @id @default(cuid())
  title        String
  sourceType   SourceType
  sourceInput  String
  frequency    Frequency
  delivery     String // json encoded array (simple for now)
  outputFormat OutputFormat
  language     Language
  triggerTime  String
  timezone     Timezone
  status       TaskStatus
  lastRunAt    DateTime?
  nextRunAt    DateTime?
  lastSummary  Json?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
}
